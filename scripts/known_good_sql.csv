prompt,sql,database_name
What is the full movie name with top rating?,"SELECT max(R.AVERAGE_RATING) AS MAX_RATING, B.PRIMARY_TITLE FROM IMDB.TITLE_BASICS AS B INNER JOIN IMDB.TITLE_RATINGS AS R ON B.TCONST = R.TCONST GROUP BY B.PRIMARY_TITLE ORDER BY MAX_RATING DESC LIMIT 1;",imdb
Which person (with actual-name) has the highest number of movies?,"select n.primary_name, count(t.tconst) as movie_count from imdb.name_basics n join imdb.title_principals t on n.nconst = t.nconst group by n.primary_name order by movie_count desc limit 1;",imdb
Which person (with full name of one person) has directed the most number of movies?,SELECT T1.PRIMARY_NAME FROM IMDB.NAME_BASICS AS T1 INNER JOIN IMDB.TITLE_CREW AS T2 ON T1.NCONST = T2.DIRECTORS ORDER BY DIRECTORS DESC LIMIT 1;,imdb
What movie(with actual name) has maximum number of votes?,"SELECT b.primary_title, a.num_votes FROM imdb.title_ratings AS a JOIN imdb.title_basics AS b ON a.tconst = b.tconst ORDER BY a.num_votes DESC LIMIT 1;",imdb
Find all actual movie name with a rating above 8.0,SELECT IMDB.TITLE_BASICS.PRIMARY_TITLE FROM IMDB.TITLE_BASICS WHERE IMDB.TITLE_BASICS.TCONST IN( SELECT IMDB.TITLE_RATINGS.TCONST FROM IMDB.TITLE_RATINGS WHERE IMDB.TITLE_RATINGS.AVERAGE_RATING > 8.0 );,imdb
Which city had maximum number of sales?,"SELECT COUNT(SALES.ID_STORE), STORES.CITY_ID FROM RETAIL.SALES SALES JOIN RETAIL.STORES STORES ON SALES.ID_STORE = STORES.ID_STORE GROUP BY 2 ORDER BY COUNT(SALES.ID_STORE) DESC LIMIT 1",retail
Which unique products share same parent hierarchy?,select distinct T1.ID_PRODUCT from RETAIL.PRODUCTS AS T1 INNER JOIN RETAIL.PRODUCTS AS T2 ON T1.HIERARCHY1_ID = T2.HIERARCHY1_ID where T1.ID_PRODUCT <> T2.ID_PRODUCT,retail
Which product (with product details) was sold with the maximum discount?,"select p.product_length, p.product_depth, p.product_width, p.cluster_id, p.hierarchy1_id, p.hierarchy2_id, p.hierarchy3_id, p.hierarchy4_id, p.hierarchy5_id, max(cast(s.promo_discount_2 as numeric)) as max_discount from retail.products as p join retail.sales as s on p.id_product = s.id_product group by p.product_length, p.product_depth, p.product_width, p.cluster_id, p.hierarchy1_id, p.hierarchy2_id, p.hierarchy3_id, p.hierarchy4_id, p.hierarchy5_id order by max_discount desc limit 1",retail
Which city has maximum number of sales?,"select st.city_id, count(st.city_id) as city_sales_count from retail.sales as s join retail.stores as st on s.id_store = st.id_store group by st.city_id order by city_sales_count desc limit 1",retail
Which product was sold most number of times?,"select p.id_product, count(p.id_product) as product_sales_count from retail.sales as s join retail.products as p on s.id_product = p.id_product group by p.id_product order by product_sales_count desc limit 1",retail
Which city has maximum number of stores?,"select count(retail.stores.city_id), retail.stores.city_id from retail.stores group by 2 order by 1 desc limit 1",retail